<h1>Organizations</h1>

<p class="org-muted">
  Organizations you belong to, with your role in each workspace.
</p>

<div class="org-actions" style="margin-bottom: 14px;">
  <%= link_to "Create Organization", new_organization_path, class: "org-button primary" %>
</div>

<% if @organizations.blank? %>
  <p>No organizations yet.</p>
<% else %>
  <% role_by_org = @memberships.index_by(&:organization_id) %>

  <table class="org-table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Your role</th>
        <th>Members</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @organizations.each do |organization| %>
        <% membership = role_by_org[organization.id] %>
        <tr>
          <td>
            <strong><%= organization.name %></strong><br>
            <span class="org-muted"><%= organization.slug %></span>
          </td>
          <td><%= membership&.role&.humanize || "Unknown" %></td>
          <td><%= organization.member_count %></td>
          <td class="org-actions">
            <% if current_organization&.id != organization.id %>
              <%= button_to "Switch", switch_organization_path(organization), method: :post, class: "org-button" %>
            <% end %>
            <%= link_to "Open", organization_path(organization), class: "org-button" %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>
