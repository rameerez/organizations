<div class="flex min-h-[60vh] items-center justify-center px-4">
  <div class="max-w-lg w-full">
    <div class="bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden">
      <%# Header with organization branding %>
      <div class="px-8 py-10 text-center bg-gradient-to-br from-emerald-500 to-emerald-600">
        <div class="mx-auto h-20 w-20 rounded-2xl bg-white/20 backdrop-blur flex items-center justify-center mb-5 shadow-lg">
          <span class="text-3xl font-bold text-white"><%= @invitation.organization.name.first.upcase %></span>
        </div>
        <h1 class="text-2xl font-bold text-white mb-2">You're Invited!</h1>
        <p class="text-emerald-100">Join <strong class="text-white"><%= @invitation.organization.name %></strong></p>
      </div>

      <div class="p-8">
        <%# Role badge %>
        <div class="flex justify-center mb-6">
          <span class="inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm font-semibold
            <%= case @invitation.role
                when 'owner' then 'bg-amber-100 text-amber-800'
                when 'admin' then 'bg-purple-100 text-purple-800'
                when 'member' then 'bg-blue-100 text-blue-800'
                else 'bg-gray-100 text-gray-800'
                end %>">
            <%= heroicon "user-circle", variant: :solid, options: { class: "h-5 w-5" } %>
            You'll join as <%= @invitation.role.capitalize %>
          </span>
        </div>

        <%# Invited by info %>
        <div class="text-center mb-8">
          <p class="text-sm text-gray-500">
            Invited by
            <span class="font-medium text-gray-700"><%= @invitation.invited_by&.respond_to?(:email) ? @invitation.invited_by.email : "a team member" %></span>
          </p>
        </div>

        <% if @invitation.expired? %>
          <div class="rounded-xl bg-red-50 p-5 border border-red-200">
            <div class="flex items-center justify-center gap-3 text-red-800">
              <%= heroicon "clock", variant: :solid, options: { class: "h-6 w-6 text-red-500" } %>
              <div>
                <p class="font-semibold">Invitation Expired</p>
                <p class="text-sm text-red-600">Ask the sender to send a new invitation.</p>
              </div>
            </div>
          </div>
        <% elsif @invitation.accepted? %>
          <div class="rounded-xl bg-emerald-50 p-5 border border-emerald-200">
            <div class="flex items-center justify-center gap-3 text-emerald-800">
              <%= heroicon "check-circle", variant: :solid, options: { class: "h-6 w-6 text-emerald-500" } %>
              <div>
                <p class="font-semibold">Already Accepted</p>
                <p class="text-sm text-emerald-600">This invitation has already been accepted.</p>
              </div>
            </div>
          </div>
        <% else %>
          <% if @user_is_logged_in && @user_email_matches %>
            <%= button_to accept_invitation_path(@invitation.token),
              method: :post,
              class: "w-full inline-flex items-center justify-center gap-3 rounded-xl bg-emerald-600 px-6 py-4 text-base font-bold text-white shadow-lg hover:bg-emerald-500 hover:shadow-xl transition-all" do %>
              <%= heroicon "check-circle", variant: :solid, options: { class: "h-6 w-6" } %>
              Accept & Join Team
            <% end %>
            <p class="mt-4 text-center text-xs text-gray-400">
              You'll be redirected to the organization dashboard
            </p>
          <% elsif @user_is_logged_in %>
            <div class="rounded-xl bg-amber-50 p-5 border border-amber-200 mb-6">
              <div class="flex items-start gap-3">
                <%= heroicon "exclamation-triangle", variant: :solid, options: { class: "h-6 w-6 text-amber-500 flex-shrink-0" } %>
                <div>
                  <p class="font-semibold text-amber-800">Email Mismatch</p>
                  <p class="text-sm text-amber-700 mt-1">
                    This invitation was sent to <strong><%= @invitation.email %></strong>,
                    but you're signed in as a different user.
                  </p>
                </div>
              </div>
            </div>
          <% else %>
            <p class="text-center text-sm text-gray-600 mb-6">
              Sign in or register with <strong class="text-gray-900"><%= @invitation.email %></strong> to accept.
            </p>
            <%= button_to accept_invitation_path(@invitation.token),
              method: :post,
              class: "w-full inline-flex items-center justify-center gap-3 rounded-xl bg-emerald-600 px-6 py-4 text-base font-bold text-white shadow-lg hover:bg-emerald-500 hover:shadow-xl transition-all" do %>
              Continue
              <%= heroicon "arrow-right", variant: :solid, options: { class: "h-6 w-6" } %>
            <% end %>
          <% end %>
        <% end %>
      </div>
    </div>

    <p class="mt-8 text-center text-sm text-gray-400">
      <%= link_to "â† Back to home", main_app.root_path, class: "text-gray-500 hover:text-gray-700 transition-colors" %>
    </p>
  </div>
</div>
